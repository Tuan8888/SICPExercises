;; Exercise 1.23
;; 改进的求最小因子函数
;; 当不能被2整除，跳过所有偶数因子的尝试
#lang racket

;; 改进的求解最小因子函数
(define (fast-smallest-divisor n)
  (findDivisorIter n 2))

(define ( n divisor)
  (cond ((> (* divisor divisor) n) n)
        ((isDivisor? n divisor) divisor)
        (else (findDivisorIter n (next divisor)))))

(define (isDivisor? n divisor)
  (= (remainder n divisor) 0))

(define (next divisor)
  (if (= divisor 2)
      3
      (+ divisor 2)))
